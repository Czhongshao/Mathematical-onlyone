# B题 工序安排问题解题思路

## 问题背景

B题是关于成衣制造厂的工序安排问题。该厂有三条相同的服装生产流水线，每条流水线包含裁剪、缝制、水洗、熨烫、包装五道工序。工人根据熟练程度分为五级，不同级别的工人可以从事不同的工序，且有不同的工作效率和故障率。题目要求确定工人的分配方案和培训策略，使总利润最大化。

## B问题1：测算最优安排下不同工序的故障损失

### 符号说明

| 符号      | 含义                                   | 单位         |
|-----------|----------------------------------------|--------------|
| $x_{ij}$  | 第 $i$ 级技工分配到第 $j$ 道工序的人数 | 人           |
| $y_i$     | 第 $i$ 级技工提升到 $i+1$ 级的人数     | 人           |
| $N_i$     | 第 $i$ 级技工现有人数                  | 人           |
| $R_j$     | 第 $j$ 道工序所需总人数                | 人           |
| $f_{ij}$  | 第 $i$ 级技工在第 $j$ 道工序的故障率   | 无量纲（%）   |
| $F_j$     | 第 $j$ 道工序的平均故障率              | 无量纲（%）   |
| $\lambda_j$ | 第 $j$ 道工序单位时间故障次数        | 次/小时      |
| $L_j$     | 第 $j$ 道工序单次故障损失              | 元/次        |
| $T$       | 总工作小时数                           | 小时         |
| $D_j$     | 第 $j$ 道工序的故障损失                | 元           |
| $D$       | 总故障损失                             | 元           |
| $e_{ij}$  | 第 $i$ 级技工在第 $j$ 道工序的效率     | 件/天        |
| $H$       | 每天工作小时数                         | 小时/天      |
| $S$       | 生产天数                               | 天           |
| $Q_j$     | 第 $j$ 道工序的产量                    | 件           |
| $Q$       | 总产量（由瓶颈工序决定）               | 件           |
| $p$       | 每件产品利润（固定为40）               | 元/件        |
| $c_i$     | 第 $i$ 级技工提升到 $i+1$ 级的培训费用 | 元/人        |
| $C$       | 总培训费用                             | 元           |
| $P$       | 总利润                                 | 元           |

### 解题思路1

1. **建立混合整数规划模型**：

   - **决策变量定义**：
     - $x_{ij}$：第 $i$ 级技工分配到第 $j$ 道工序的人数，$x_{ij} \in \mathbb{Z}_{\geq 0}$，$i=1,2,3,4,5$，$j=1,2,3,4,5$。
     - $y_i$：第 $i$ 级技工提升到 $i+1$ 级的人数，$y_i \in \mathbb{Z}_{\geq 0}$，$i=1,2,3,4$。

2. **约束条件**：

   - **人员总数约束**：
     $$
     \sum_{j=1}^{5} x_{ij} + y_i \leq N_i, \quad \forall i=1,2,3,4
     $$
     其中，$\sum_{j=1}^{5} x_{ij}$ 表示第 $i$ 级技工分配到所有工序的总人数，$y_i$ 表示第 $i$ 级技工提升到 $i+1$ 级的人数，$N_i$ 表示第 $i$ 级技工现有人数。该约束确保每级技工的分配和培训人数不超过现有人数。

     $$
     \sum_{j=1}^{5} x_{5j} \leq N_5 + y_4
     $$
     其中，$\sum_{j=1}^{5} x_{5j}$ 表示第5级技工分配到所有工序的总人数，$N_5$ 表示第5级技工现有人数，$y_4$ 表示从第4级提升到第5级的技工人数。该约束确保第5级技工的分配不超过现有人数加上新培训的人数。

   - **工序需求约束**：
     $$
     \sum_{i=1}^{5} x_{ij} \geq R_j, \quad \forall j=1,2,3,4,5
     $$
     其中，$\sum_{i=1}^{5} x_{ij}$ 表示所有级别技工分配到第 $j$ 道工序的总人数，$R_j$ 表示第 $j$ 道工序所需的最低人数。该约束确保每道工序分配的人数满足最低需求。

   - **培训人数约束**：
     $$
     0 \leq y_i \leq N_i, \quad y_i \in \mathbb{Z}, \quad \forall i=1,2,3,4
     $$
     其中，$y_i$ 表示第 $i$ 级技工提升到 $i+1$ 级的人数，$N_i$ 表示第 $i$ 级技工现有人数，$\mathbb{Z}$ 表示整数集。该约束确保培训人数为非负整数且不超过现有人数。

   - **总产量 $Q$ 的计算**：
     $$
     Q_j = \sum_{i=1}^{5} x_{ij} \cdot e_{ij} \cdot S, \quad Q = \min_{j=1,\ldots,5} Q_j
     $$
     其中，$Q_j$ 表示第 $j$ 道工序的产量，$x_{ij}$ 表示第 $i$ 级技工分配到第 $j$ 道工序的人数，$e_{ij}$ 表示第 $i$ 级技工在第 $j$ 道工序的效率（件/天），$S$ 表示生产天数。$Q$ 表示总产量，由产能最低的工序（瓶颈工序）决定。

   - **故障损失 $D$ 的计算**：
     $$
     F_j = \frac{\sum_{i=1}^{5} x_{ij} f_{ij}}{\sum_{i=1}^{5} x_{ij}}
     $$
     其中，$F_j$ 表示第 $j$ 道工序的平均故障率，$x_{ij}$ 表示第 $i$ 级技工分配到第 $j$ 道工序的人数，$f_{ij}$ 表示第 $i$ 级技工在第 $j$ 道工序的故障率。该公式计算的是第 $j$ 道工序的加权平均故障率。

     $$
     \lambda_j = F_j \times \sum_{i=1}^{5} x_{ij}
     $$
     其中，$\lambda_j$ 表示第 $j$ 道工序单位时间故障次数，$F_j$ 表示第 $j$ 道工序的平均故障率，$\sum_{i=1}^{5} x_{ij}$ 表示分配到第 $j$ 道工序的总人数。该公式计算的是第 $j$ 道工序的总故障频率。

     $$
     D_j = \lambda_j \times T \times L_j
     $$
     其中，$D_j$ 表示第 $j$ 道工序的故障损失，$\lambda_j$ 表示第 $j$ 道工序单位时间故障次数，$T$ 表示总工作小时数，$L_j$ 表示第 $j$ 道工序单次故障损失。该公式计算的是第 $j$ 道工序在整个生产周期内的总故障损失。

     $$
     D = \sum_{j=1}^{5} D_j
     $$
     其中，$D$ 表示总故障损失，$D_j$ 表示第 $j$ 道工序的故障损失。该公式计算的是所有工序的故障损失总和。

   - **培训费用 $C$ 的计算**：
     $$
     C = \sum_{i=1}^{4} y_i \cdot c_i
     $$
     其中，$C$ 表示总培训费用，$y_i$ 表示第 $i$ 级技工提升到 $i+1$ 级的人数，$c_i$ 表示第 $i$ 级技工提升到 $i+1$ 级的单位培训费用。该公式计算的是所有技工培训的总费用。

3. **目标函数**：

   - **最大化总利润**：
     $$
     \max \left\{ P = Q \cdot p - D - C \right\}
     $$
     其中：
     - $Q$：总产量（由产能瓶颈工序决定，见下式）
     - $p$：每件产品利润
     - $D$：总故障损失
     - $C$：总培训费用

   - **总产量 $Q$ 的计算**：
     $$
     Q_j = \sum_{i=1}^{5} x_{ij} \cdot e_{ij} \cdot S, \quad Q = \min_{j=1,\ldots,5} Q_j
     $$

   - **故障损失 $D$ 的计算**：
     $$
     F_j = \frac{\sum_{i=1}^{5} x_{ij} f_{ij}}{\sum_{i=1}^{5} x_{ij}}
     $$
     $$
     \lambda_j = F_j \times \sum_{i=1}^{5} x_{ij}
     $$
     $$
     D_j = \lambda_j \times T \times L_j
     $$
     $$
     D = \sum_{j=1}^{5} D_j
     $$

   - **培训费用 $C$ 的计算**：
     $$
     C = \sum_{i=1}^{4} y_i \cdot c_i
     $$

4. **敏感性分析**：

   - 对模型中的关键参数（如 $F_j$、$L_j$、$e_{ij}$、$c_i$ 等）进行扰动，分析其对目标函数 $P$ 的影响。
   - 计算各参数对 $P$ 的偏导数，确定敏感性最大的工序或参数。

## B问题2：测算4周总利润及敏感性分析

### 解题思路2

1. **时间参数设定**：

   - **工作时间计算**：
     - 每周工作5天，每天8小时
     - 总工作时间 $T = 4 \text{周} \times 5 \text{天/周} \times 8 \text{小时/天} = 160 \text{小时}$
     - 总工作天数 $S = 4 \text{周} \times 5 \text{天/周} = 20 \text{天}$

2. **模型扩展**：

   - **考虑培训时间影响**：
     - 第 $i$ 级技工培训时间为 $t_i$（单位：天）
     - 培训期间的有效工作天数 $S_i = S - t_i$
     - 对于培训的工人，其贡献的产量需要相应调整

   - **产能计算修正**：
     $$
     Q_j = \sum_{i=1}^{5} x_{ij} \cdot e_{ij} \cdot S - \sum_{i=1}^{4} y_i \cdot e_{i+1,j} \cdot t_i
     $$
     其中，第一项表示所有工人在不考虑培训的情况下的总产量，第二项表示因培训损失的产量。

3. **故障损失计算**：

   - **故障次数计算**：
     $$
     \text{故障次数}_j = \lambda_j \times T
     $$

   - **故障时间损失**：
     $$
     \text{故障时间}_j = \text{故障次数}_j \times \text{单次修复时间}_j
     $$

   - **故障材料损失**：
     $$
     D_j = \text{故障次数}_j \times L_j
     $$

   - **总故障损失**：
     $$
     D = \sum_{j=1}^{5} D_j
     $$

4. **总利润计算**：

   - **总产量**：
     $$
     Q = \min_{j=1,\ldots,5} Q_j
     $$

   - **总培训费用**：
     $$
     C = \sum_{i=1}^{4} y_i \cdot c_i
     $$

   - **总利润**：
     $$
     P = Q \cdot p - D - C
     $$
     其中，$p = 40$ 元/件为单件产品利润。

5. **敏感性分析**：

   - **参数扰动分析**：
     - 对每道工序的关键参数（如人员分配 $x_{ij}$、故障率 $f_{ij}$、工作效率 $e_{ij}$ 等）进行小幅度扰动
     - 计算扰动前后总利润的变化率：
       $$
       \text{敏感度} = \frac{\Delta P / P}{\Delta \text{参数} / \text{参数}}
       $$

   - **敏感性排序**：
     - 根据敏感度大小对各工序参数进行排序
     - 确定对总利润影响最大的工序和参数

   - **可视化分析**：
     - 绘制参数-利润关系图，直观展示敏感性
     - 分析不同工序参数变化对总利润的影响程度

## B问题3：24周生产计划安排

### 解题思路3

1. **周期划分**：

   - **时间划分**：
     - 将24周划分为6个4周周期，记为 $k = 1, 2, \ldots, 6$
     - 每个周期内工人分配保持不变
     - 相邻周期之间工人需要更换工种

2. **模型扩展**：

   - **周期性决策变量扩展**：
     - 将原有决策变量扩展为带有周期索引的变量：$x_{ijk}$, $y_{ik}$
     - 引入工人流动变量 $z_{ij}^{k,k+1}$ 表示从周期 $k$ 的工序 $i$ 转移到周期 $k+1$ 工序 $j$ 的工人数量

   - **轮换效应考量**：
     - 考虑工人更换工种可能带来的适应期效率损失
     - 引入适应系数 $\alpha_{ij}$ 表示从工序 $i$ 转到工序 $j$ 的工人在初期的效率折损
     - 修正后的效率计算：$e_{ij}^{\prime} = e_{ij} \times (1 - \alpha_{ij} \times \beta)$，其中 $\beta$ 为适应期占比

   - **长期培训策略优化**：
     - 考虑培训的长期收益与短期成本平衡
     - 引入折现因子 $\delta$ 评估未来收益
     - 优先培训能够提升关键瓶颈工序产能的工人

   - **周期间连续性处理**：
     - 建立周期间的状态转移方程
     - 确保各级技工人数的连续性：$N_{i,k+1} = N_{ik} - y_{ik} + y_{i-1,k}$
     - 保证工人轮换的合理性：$z_{jj}^{k,k+1} = 0$（禁止连续两个周期从事同一工序）

3. **轮换约束**：

   - **工种更换约束**：
     $$
     x_{ijk} + x_{ij,k+1} \leq N_i, \quad \forall i,j,k=1,2,\ldots,5
     $$
     该约束确保同一工人不会在连续两个周期内从事相同工序。

   - **技能匹配约束**：
     若第 $i$ 级技工不能从事第 $j$ 道工序，则 $x_{ijk} = 0$。

4. **周期连续性约束**：

   - **人员平衡约束**：
     $$
     \sum_{j=1}^{5} x_{ijk} + y_{ik} \leq N_{ik}, \quad \forall i,k
     $$
     其中，$N_{ik}$ 表示第 $k$ 个周期开始时第 $i$ 级技工的人数，需要考虑前一周期的培训情况：
     $$
     N_{i,k+1} = N_{ik} - y_{ik} + y_{i-1,k}, \quad \forall i=2,3,4,5
     $$
     $$
     N_{1,k+1} = N_{1k} - y_{1k}
     $$

   - **工序需求约束**：
     $$
     \sum_{i=1}^{5} x_{ijk} \geq R_j, \quad \forall j,k
     $$

5. **周期性利润计算**：

   - **每个周期的产量**：
     $$
     Q_{jk} = \sum_{i=1}^{5} x_{ijk} \cdot e_{ij} \cdot S - \sum_{i=1}^{4} y_{ik} \cdot e_{i+1,j} \cdot t_i
     $$
     $$
     Q_k = \min_{j=1,\ldots,5} Q_{jk}
     $$

   - **每个周期的故障损失**：
     $$
     F_{jk} = \frac{\sum_{i=1}^{5} x_{ijk} f_{ij}}{\sum_{i=1}^{5} x_{ijk}}
     $$
     $$
     \lambda_{jk} = F_{jk} \times \sum_{i=1}^{5} x_{ijk}
     $$
     $$
     D_{jk} = \lambda_{jk} \times T_k \times L_j
     $$
     $$
     D_k = \sum_{j=1}^{5} D_{jk}
     $$

   - **每个周期的培训费用**：
     $$
     C_k = \sum_{i=1}^{4} y_{ik} \cdot c_i
     $$

   - **每个周期的利润**：
     $$
     P_k = Q_k \cdot p - D_k - C_k
     $$

6. **总目标函数**：

   - **最大化24周总利润**：
     $$
     \max \left\{ P = \sum_{k=1}^{6} P_k \right\}
     $$

7. **求解策略**：

   - **分阶段优化**：
     - 可以采用动态规划方法，逐个周期优化
     - 考虑当前决策对未来周期的影响

   - **整体优化**：
     - 构建完整的24周混合整数规划模型
     - 使用商业求解器（如CPLEX、Gurobi等）求解

   - **启发式算法**：
     - 对于大规模问题，可以考虑使用遗传算法、模拟退火等启发式算法
     - 设计合理的编码方式和适应度函数

8. **结果分析与验证**：

   - **方案可行性验证**：
     - 检查所有约束是否满足
     - 验证工人轮换是否符合要求

   - **利润分析**：
     - 分析各周期利润变化趋势
     - 比较不同轮换策略下的总利润差异

   - **敏感性分析**：
     - 分析关键参数变化对长期规划的影响
     - 提出应对生产波动的策略建议
